단위 테스트 (Unit Test)



단위(Unit): 특정 조건에서 어떻게 작동해야 할지 정의한 것. 대게 '함수'로 표현

준비(arrange), 실행(act), 단언(assert) 패턴을 따른다



테스트 주도개발 (TDD)

적색(Red), 녹색(Green), 리팩터(Refactor) 순환

테스트하기 쉬운 코드

관심사의 분리



설치

재스민 프레임웍을 설치하고 TDD 개발 환경을 꾸미자

1. 스탠드얼론 (standalone)
2. 카르마(karma)와 함께 설치하는 방법 (자동화) <-실무



https://github.com/jasmine/jasmine/releases

2.7.0

 압축 풀고 SpecRunner.html 실행

자스민 라이브러리 파일

소스 코드

테스트 코드



테스트 러너(Test Runner)란

* 재스민, 소스, 테스트 코드를 실행
* 스탠드 얼론으로 설치한 자스민은 HTML 파일이 테스트 러너임
* (테스트 자동화를 하려면 테스트러너인 카르마(Karma)와 함께 사용 가능)

`git checkout -f install-jasmine`



테스트 꾸러미 (Test Suite)

* describe('테스트 설명', 테스트 구현 함수)

테스트 스펙 (Test Spec)

* it ('테스트 설명', 기대식을 가진 테스트 구현 함수)

기대식과 매쳐

* expect(결과 값).toBe(기대하는 값)

스파이

* spyOn(감시할 객체, 감시할 메소드)



어떻게 하면 테스트할 수 있을까?

1. 코드를 UI에서 완전히 분리

   HTML에서 JS 코드를 떼어내면 비즈니스 로직만 테스트할 수 있음

2. 자바스크립트를 별도 파일로 분리

   다른 곳에서도 재사용할 수 있고 테스트성도 좋아짐



모듈 패턴

함수로 데이터를 감추고, 모듈 API를 담고 있는 객체를 반환하는 형태

(자바스크립트에서 가장 많이 사용되는 패턴)

1. 임의 함수를 호출하여 생성하는 모듈과
2. 즉시 실행 함수(IIFE) 기반의 모듈이 있다  // 함수 선언 즉시 실행한다. 싱글톤



모듈 생성 원칙

1. 단일 책임 원칙에 따라 모듈은 한 가지 역할만 한다

   그 역할만 집중 -> 모듈을 더욱 튼튼하게 만들고 테스트하기도 쉽다

2. 모듈 자신이 사용할 객체가 있다면 의존성 주입 형태로 제공

   또는 팩토리 주입형태로 제공

   테스트하기도 쉽다



클릭 카운터 모듈

ClickCounter는 카운터 데이터를 다루는 모듈이다

전역 공간에 있는 counter 변수를 ClickCounter 안에서 관리하자

첫번째 스펙

"ClickCounter 모듈의 getValue()는 카운터 값을 반환"

`git checkout --force ClickCounter-spec-1`

force 옵션은 현재 코드 변경사항을 다 무시하고 브랜치를 이동



테스트 코드가 있기 때문에 안심하고 리팩토링 가능

하나의 기능에 대해 Red - Green - Refactor 사이클로 개발